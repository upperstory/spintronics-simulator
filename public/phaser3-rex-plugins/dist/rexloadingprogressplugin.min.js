!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).rexloadingprogressplugin=t()}(void 0,function(){function f(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function c(r){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=a(r);if(o){var n=a(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return u(this,e)}}function t(e,t){var n;return(n=e)&&"function"==typeof n?t={config:{callback:e,scope:t}}:v(e)?(t=e).hasOwnProperty("config")||(t={config:t}):t={key:e,config:t},this.addFile(new y(this,t)),this}function l(n,r){return new Promise(function(e,t){n.once(r,function(){e()})})}function p(){}function s(o,e){var i=b(e,"transitIn",p),a=b(e,"progress",p),c=b(e,"transitionOut",p),s=o.scene;s.sys.load.rexAwait||(Phaser.Loader.FileTypesManager.register("rexAwait",t),s.sys.load.rexAwait=t),s.load.rexAwait(function(){var u,n=(u=regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(o);case 2:if(!((r=P(s))<1)){e.next=13;break}case 4:if(r<1)return e.next=7,l(s.load,"progress");e.next=11;break;case 7:r=P(s),a(o,r),e.next=4;break;case 11:e.next=14;break;case 13:a(o,r);case 14:return e.next=16,c(o);case 16:o.destroy(),t();case 18:case"end":return e.stop()}},e)}),function(){var e=this,a=arguments;return new Promise(function(t,n){var r=u.apply(e,a);function o(e){f(r,t,n,o,i,"next",e)}function i(e){f(r,t,n,o,i,"throw",e)}o(void 0)})});return function(e,t){return n.apply(this,arguments)}}())}var d=Phaser.Loader.FILE_POPULATED,h=Phaser.Utils.String.UUID,y=function(){i(r,Phaser.Loader.File);var n=c(r);function r(e,t){return o(this,r),t.hasOwnProperty("type")||(t.type="await"),t.hasOwnProperty("url")||(t.url=""),t.hasOwnProperty("key")||(t.key=h()),n.call(this,e,t)}return e(r,[{key:"load",value:function(){if(this.state===d)this.loader.nextFile(this,!0);else{var e=this.config,t=e.callback,n=e.scope,r=this.onLoad.bind(this),o=this.onError.bind(this);t?n?t.call(n,r,o):t(r,o):this.onLoad()}}},{key:"onLoad",value:function(){this.loader.nextFile(this,!0)}},{key:"onError",value:function(){this.loader.nextFile(this,!1)}}]),r}(),v=Phaser.Utils.Objects.IsPlainObject,b=Phaser.Utils.Objects.GetValue,P=function(e){var t=e.load,n=t.totalToLoad-1;return 1-(t.list.size+t.inflight.size-1)/n};return function(){i(n,Phaser.Plugins.BasePlugin);var t=c(n);function n(e){return o(this,n),t.call(this,e)}return e(n,[{key:"add",value:function(e,t){s(e,t)}},{key:"addDelayPromise",value:function(e){return void 0===(n=e)&&(n=0),new Promise(function(e,t){setTimeout(function(){e(r)},n)});var n,r}}]),n}()});

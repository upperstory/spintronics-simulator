!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).rexlzstringplugin=t()}(void 0,function(){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function e(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function t(o){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(o);if(r){var n=i(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return u(this,e)}}var n,c=(function(e){var v,n,o,r,s,t=(v=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={},s={compressToBase64:function(e){if(null==e)return"";var t=s._compress(e,6,function(e){return n.charAt(e)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:s._decompress(t.length,32,function(e){return i(n,t.charAt(e))})},compressToUTF16:function(e){return null==e?"":s._compress(e,15,function(e){return v(e+32)})+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:s._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array:function(e){for(var t=s.compress(e),n=new Uint8Array(2*t.length),o=0,r=t.length;o<r;o++){var i=t.charCodeAt(o);n[2*o]=i>>>8,n[2*o+1]=i%256}return n},decompressFromUint8Array:function(e){if(null==e)return s.decompress(e);for(var t=new Array(e.length/2),n=0,o=t.length;n<o;n++)t[n]=256*e[2*n]+e[2*n+1];var r=[];return t.forEach(function(e){r.push(v(e))}),s.decompress(r.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":s._compress(e,6,function(e){return o.charAt(e)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),s._decompress(t.length,32,function(e){return i(o,t.charAt(e))}))},compress:function(e){return s._compress(e,16,function(e){return v(e)})},_compress:function(e,t,n){if(null==e)return"";var o,r,i,s={},u={},c="",a="",p="",f=2,l=3,h=2,d=[],m=0,y=0;for(i=0;i<e.length;i+=1)if(c=e.charAt(i),Object.prototype.hasOwnProperty.call(s,c)||(s[c]=l++,u[c]=!0),a=p+c,Object.prototype.hasOwnProperty.call(s,a))p=a;else{if(Object.prototype.hasOwnProperty.call(u,p)){if(p.charCodeAt(0)<256){for(o=0;o<h;o++)m<<=1,y==t-1?(y=0,d.push(n(m)),m=0):y++;for(r=p.charCodeAt(0),o=0;o<8;o++)m=m<<1|1&r,y==t-1?(y=0,d.push(n(m)),m=0):y++,r>>=1}else{for(r=1,o=0;o<h;o++)m=m<<1|r,y==t-1?(y=0,d.push(n(m)),m=0):y++,r=0;for(r=p.charCodeAt(0),o=0;o<16;o++)m=m<<1|1&r,y==t-1?(y=0,d.push(n(m)),m=0):y++,r>>=1}0==--f&&(f=Math.pow(2,h),h++),delete u[p]}else for(r=s[p],o=0;o<h;o++)m=m<<1|1&r,y==t-1?(y=0,d.push(n(m)),m=0):y++,r>>=1;0==--f&&(f=Math.pow(2,h),h++),s[a]=l++,p=String(c)}if(""!==p){if(Object.prototype.hasOwnProperty.call(u,p)){if(p.charCodeAt(0)<256){for(o=0;o<h;o++)m<<=1,y==t-1?(y=0,d.push(n(m)),m=0):y++;for(r=p.charCodeAt(0),o=0;o<8;o++)m=m<<1|1&r,y==t-1?(y=0,d.push(n(m)),m=0):y++,r>>=1}else{for(r=1,o=0;o<h;o++)m=m<<1|r,y==t-1?(y=0,d.push(n(m)),m=0):y++,r=0;for(r=p.charCodeAt(0),o=0;o<16;o++)m=m<<1|1&r,y==t-1?(y=0,d.push(n(m)),m=0):y++,r>>=1}0==--f&&(f=Math.pow(2,h),h++),delete u[p]}else for(r=s[p],o=0;o<h;o++)m=m<<1|1&r,y==t-1?(y=0,d.push(n(m)),m=0):y++,r>>=1;0==--f&&(f=Math.pow(2,h),h++)}for(r=2,o=0;o<h;o++)m=m<<1|1&r,y==t-1?(y=0,d.push(n(m)),m=0):y++,r>>=1;for(;;){if(m<<=1,y==t-1){d.push(n(m));break}y++}return d.join("")},decompress:function(t){return null==t?"":""==t?null:s._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress:function(e,t,n){var o,r,i,s,u,c,a,p=[],f=4,l=4,h=3,d="",m=[],y={val:n(0),position:t,index:1};for(o=0;o<3;o+=1)p[o]=o;for(i=0,u=Math.pow(2,2),c=1;c!=u;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=t,y.val=n(y.index++)),i|=(0<s?1:0)*c,c<<=1;switch(i){case 0:for(i=0,u=Math.pow(2,8),c=1;c!=u;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=t,y.val=n(y.index++)),i|=(0<s?1:0)*c,c<<=1;a=v(i);break;case 1:for(i=0,u=Math.pow(2,16),c=1;c!=u;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=t,y.val=n(y.index++)),i|=(0<s?1:0)*c,c<<=1;a=v(i);break;case 2:return""}for(r=p[3]=a,m.push(a);;){if(y.index>e)return"";for(i=0,u=Math.pow(2,h),c=1;c!=u;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=t,y.val=n(y.index++)),i|=(0<s?1:0)*c,c<<=1;switch(a=i){case 0:for(i=0,u=Math.pow(2,8),c=1;c!=u;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=t,y.val=n(y.index++)),i|=(0<s?1:0)*c,c<<=1;p[l++]=v(i),a=l-1,f--;break;case 1:for(i=0,u=Math.pow(2,16),c=1;c!=u;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=t,y.val=n(y.index++)),i|=(0<s?1:0)*c,c<<=1;p[l++]=v(i),a=l-1,f--;break;case 2:return m.join("")}if(0==f&&(f=Math.pow(2,h),h++),p[a])d=p[a];else{if(a!==l)return null;d=r+r.charAt(0)}m.push(d),p[l++]=r+d.charAt(0),r=d,0==--f&&(f=Math.pow(2,h),h++)}}});function i(e,t){if(!r[e]){r[e]={};for(var n=0;n<e.length;n++)r[e][e.charAt(n)]=n}return r[e][t]}null!=e&&(e.exports=t)}(n={exports:{}}),n.exports),a=Phaser.Utils.Objects.GetFastValue,p=function(){function t(e){r(this,t),this.resetFromJSON(e)}return e(t,[{key:"resetFromJSON",value:function(e){return this.setEncoding(a(e,"encoding",0)),this}},{key:"toJSON",value:function(){return{encoding:this.encoding}}},{key:"setEncoding",value:function(e){return void 0===e?e=0:"string"==typeof e&&(e=f[e.toLowerCase()]||0),this.encoding=e,this}},{key:"compress",value:function(e){var t=l[this.encoding];return c[t](e)}},{key:"decompress",value:function(e){var t=h[this.encoding];return c[t](e)}}]),t}(),f={none:0,base64:1,utf16:2,uri:3},l=["compress","compressToBase64","compressToUTF16","compressToEncodedURIComponent"],h=["decompress","decompressFromBase64","decompressFromUTF16","decompressFromEncodedURIComponent"];return function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(o,Phaser.Plugins.BasePlugin);var n=t(o);function o(e){var t;return r(this,o),(t=n.call(this,e)).lzstring=new p,t}return e(o,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"destroy",value:function(){this.lzstring=null,this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}},{key:"add",value:function(e){return new p(e)}}]),o}()});

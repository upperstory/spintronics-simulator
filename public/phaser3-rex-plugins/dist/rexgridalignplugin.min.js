!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rexgridalignplugin=e()}(void 0,function(){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function t(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=o(n);if(r){var i=o(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return h(this,t)}}function i(t,e,i){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e))return t[e];if(-1===e.indexOf("."))return i;for(var n=e.split("."),r=t,o=i,s=0;s<n.length;s++){if(!r.hasOwnProperty(n[s])){o=i;break}o=r[n[s]],r=r[n[s]]}return o}return i}var c=Math.sqrt(3),a=Math.sqrt(3),e=0,f=1,l=2,d=3,g=e,y=f,v=l,p=d,x={},b=e,w=f,k=l,O=d,_={},W={},m=e,P=f,X=l,Y=d,T={},z={},j=e,M=f,S=l,H=d,C=function(){function e(t){n(this,e),this.resetFromJSON(t)}return t(e,[{key:"resetFromJSON",value:function(t){this.setType(i(t,"staggeraxis",1),i(t,"staggerindex",1)),this.setDirectionMode(),this.setOriginPosition(i(t,"x",0),i(t,"y",0));var e=i(t,"size",void 0);void 0!==e?this.setCellRadius(e):this.setCellSize(i(t,"cellWidth",0),i(t,"cellHeight",0))}},{key:"setType",value:function(t,e){return"string"==typeof t&&(t=E[t]),"string"==typeof e&&(e=F[e]),this.staggeraxis=t,this.staggerindex=e,this.mode=0===t?0===e?H:S:0===e?M:j,this}},{key:"setDirectionMode",value:function(){return this.directions=6,this}},{key:"setOriginPosition",value:function(t,e){return this.x=t,this.y=e,this}},{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._halfWidth=t/2}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._halfHeight=t/2}},{key:"setCellSize",value:function(t,e){return this.width=t,this.height=e,this}},{key:"setCellRadius",value:function(t){this.size=t;var e,i,n={size:this.size,type:this.staggeraxis},r=0===(e=n).type?2*e.size:c*e.size,o=0===(i=n).type?a*i.size:2*i.size;return this.setCellSize(r,o),this}},{key:"cellWidth",get:function(){return this.width},set:function(t){this.width=t}},{key:"cellHeight",get:function(){return this.height},set:function(t){this.height=t}}]),e}(),R={getWorldXY:function(t,e,i){void 0===i?i={}:!0===i&&(i=x);var n=t*this.width,r=e*this.height;switch(this.mode){case g:1&e&&(n+=this._halfWidth),r*=.75;break;case y:1&e&&(n-=this._halfWidth),r*=.75;break;case v:n*=.75,1&t&&(r+=this._halfHeight);break;case p:n*=.75,1&t&&(r-=this._halfHeight)}return n+=this.x,r+=this.y,i.x=n,i.y=r,i},getWorldX:function(t,e){return this.getWorldXY(t,e,!0).x},getWorldY:function(t,e){return this.getWorldXY(t,e,!0).y},getTileXY:function(t,e,i){var n,r;switch(void 0===i?i={}:!0===i&&(i=z),t-=this.x,e-=this.y,this.mode){case m:case P:r=e*(4/3)/this.height,n=t/this.width-2/3*(e/this.height);break;case X:case Y:r=e/this.height-2/3*(t/this.width),n=t*(4/3)/this.width}var o,s,h,u=(o=n,s=r,void 0===(h=T)?h={}:!0===h&&(h=_),h.x=o,h.y=-o-s,h.z=s,h);return function(t,e,i,n){"number"!=typeof t&&(t=(n=t).x,e=n.y,i=n.z),void 0===n?n={}:!0===n&&(n=_);var r=Math.round(t),o=Math.round(e),s=Math.round(i),h=Math.abs(r-t),u=Math.abs(o-e),c=Math.abs(s-i);u<h&&c<h?r=-o-s:c<u?o=-r-s:s=-r-o,n.x=r,n.y=o,n.z=s}(u),function(t,e,i,n){switch(void 0===n?n={}:!0===n&&(n=W),t){case b:n.x=e+(i-(1&i))/2,n.y=i;break;case w:n.x=e+(i+(1&i))/2,n.y=i;break;case k:n.x=e,n.y=i+(e-(1&e))/2;break;case O:n.x=e,n.y=i+(e+(1&e))/2}}(this.mode,u.x,(u.y,u.z),i),i},getTileX:function(t,e){return this.getTileXY(t,e,!0).x},getTileY:function(t,e){return this.getTileXY(t,e,!0).y}};Object.assign(C.prototype,R);function D(){}var E={y:0,x:1},F={even:0,odd:1},N=new Phaser.GameObjects.Zone({sys:{queueDepthSort:D,events:{once:D}}},0,0,1,1);N.setOrigin(0);function q(t){return void 0!==t.displayWidth?t.displayWidth:t.width}function J(t){return void 0!==t.displayHeight?t.displayHeight:t.height}function B(t){var e=J(t);return t.y+e-e*t.originY}function G(t){var e=q(t);return t.x-e*t.originX+.5*e}function A(t,e){var i=J(t);return t.y=e-i+i*t.originY,t}function U(t,e){var i=q(t),n=i*t.originX;return t.x=e+n-.5*i,t}function V(t){var e=q(t);return t.x-e*t.originX}function Z(t,e){var i=q(t);return t.x=e+i*t.originX,t}function I(t){var e=q(t);return t.x+e-e*t.originX}function K(t,e){var i=q(t);return t.x=e-i+i*t.originX,t}function L(t,e){var i=J(t),n=i*t.originY;return t.y=e+n-.5*i,t}function Q(t){var e=J(t);return t.y-e*t.originY+.5*e}function $(t){var e=J(t);return t.y-e*t.originY}function tt(t,e){var i=J(t);return t.y=e+i*t.originY,t}var et=0,it=1,nt=2,rt=4,ot=6,st=8,ht=10,ut=12,ct=[];ct[11]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),U(t,G(e)+i),A(t,B(e)+n),t},ct[ht]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),Z(t,V(e)-i),A(t,B(e)+n),t},ct[ut]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),K(t,I(e)+i),A(t,B(e)+n),t},ct[ot]=function(t,e,i,n){var r,o,s;return void 0===i&&(i=0),void 0===n&&(n=0),r=t,o=G(e)+i,s=Q(e)+n,U(r,o),L(r,s),t},ct[rt]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),Z(t,V(e)-i),L(t,Q(e)+n),t},ct[st]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),K(t,I(e)+i),L(t,Q(e)+n),t},ct[it]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),U(t,G(e)+i),tt(t,$(e)-n),t},ct[et]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),Z(t,V(e)-i),tt(t,$(e)-n),t},ct[nt]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),K(t,I(e)+i),tt(t,$(e)-n),t};function at(t,e,i,n,r){return ct[i](t,e,n,r)}var ft=Phaser.Utils.Objects.GetFastValue,lt=new C,dt={},gt={},yt=function(){function e(t){n(this,e),this.resetFromJSON(t)}return t(e,[{key:"resetFromJSON",value:function(t){this.setType(i(t,"type",0)),this.setDirectionMode(i(t,"dir",4)),this.setOriginPosition(i(t,"x",0),i(t,"y",0)),this.setCellSize(i(t,"cellWidth",0),i(t,"cellHeight",0))}},{key:"setType",value:function(t){return"string"==typeof t&&(t=pt[t]),this.mode=t,this}},{key:"setDirectionMode",value:function(t){return"string"==typeof t&&(t=xt[t]),this.directions=t,this}},{key:"setOriginPosition",value:function(t,e){return this.x=t,this.y=e,this}},{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._halfWidth=t/2}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._halfHeight=t/2}},{key:"setCellSize",value:function(t,e){return this.width=t,this.height=e,this}},{key:"cellWidth",get:function(){return this.width},set:function(t){this.width=t}},{key:"cellHeight",get:function(){return this.height},set:function(t){this.height=t}}]),e}(),vt={getWorldXY:function(t,e,i){var n,r;switch(void 0===i?i={}:!0===i&&(i=dt),this.mode){case 0:n=t*this.width,r=e*this.height;break;case 1:n=(t-e)*this._halfWidth,r=(t+e)*this._halfHeight}return n+=this.x,r+=this.y,i.x=n,i.y=r,i},getWorldX:function(t,e){return this.getWorldXY(t,e,!0).x},getWorldY:function(t,e){return this.getWorldXY(t,e,!0).y},getTileXY:function(t,e,i){void 0===i?i={}:!0===i&&(i=gt),t-=this.x,e-=this.y;var n=t/this.width,r=e/this.height;switch(this.mode){case 0:i.x=Math.round(n),i.y=Math.round(r);break;case 1:i.x=Math.round(+n+r),i.y=Math.round(r-n)}return i},getTileX:function(t,e){return this.getTileXY(t,e,!0).x},getTileY:function(t,e){return this.getTileXY(t,e,!0).y}};Object.assign(yt.prototype,vt);var pt={orthogonal:0,isometric:1,staggered:2},xt={"4dir":4,"8dir":8},bt=Phaser.Utils.Objects.GetFastValue,wt=new yt;return function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(i,Phaser.Plugins.BasePlugin);var e=u(i);function i(t){return n(this,i),e.call(this,t)}return t(i,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"hexagon",value:function(t,e){return function(t,e){void 0===e&&(e={});var i=ft(e,"width",-1),n=ft(e,"height",-1),r=ft(e,"cellWidth",1),o=ft(e,"cellHeight",r),s=ft(e,"staggeraxis",1),h=ft(e,"staggerindex",1),u=ft(e,"position",Phaser.Display.Align.CENTER),c=ft(e,"x",0),a=ft(e,"y",0);lt.setOriginPosition(c,a).setCellSize(r,o).setType(s,h),N.setSize(r,o);for(var f=n-1,l=i-1,d=0,g=0,y=0,v=t.length;y<v;y++)if(lt.getWorldXY(g,d,N),at(t[y],N,u),-1===i)d++;else if(-1===n)g++;else if(g===l){if(d===f)break;g=0,d++}else g++;return t}(t,e)}},{key:"quad",value:function(t,e){return function(t,e){void 0===e&&(e={});var i=bt(e,"width",-1),n=bt(e,"height",-1),r=bt(e,"cellWidth",1),o=bt(e,"cellHeight",r),s=bt(e,"type",0),h=bt(e,"position",Phaser.Display.Align.CENTER),u=bt(e,"x",0),c=bt(e,"y",0);wt.setOriginPosition(u,c).setCellSize(r,o).setType(s),N.setSize(r,o);for(var a=n-1,f=i-1,l=0,d=0,g=0,y=t.length;g<y;g++)if(wt.getWorldXY(d,l,N),at(t[g],N,h),-1===i)l++;else if(-1===n)d++;else if(d===f){if(l===a)break;d=0,l++}else d++;return t}(t,e)}}]),i}()});

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rexbuffdataplugin=e()}(void 0,function(){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function f(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n(t,e)}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(s){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=i(s);if(r){var n=i(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return a(t)}(this,t)}}function c(t){return void 0===t.buffs&&(t.baseValues={},t.buffs={},t.bounds={}),void 0===t.addBuff&&Object.assign(t,e),t}var u=function(){function t(){o(this,t),this.buffs={}}return f(t,[{key:"setEnable",value:function(t,e){return void 0===e&&(e=!0),this.buffs.hasOwnProperty(t)||(this.buffs[t]={enable:!0,value:0,type:l}),this.buffs[t].enable=e,this}},{key:"set",value:function(t,e){this.setEnable(t);var n=r(e);"number"===n?n=l:"string"===n&&(e=-1!==e.indexOf("%")?(n=b,parseFloat(e)/100):(n=l,parseFloat(e)));var s=this.buffs[t];return s.value=e,s.type=n,this}},{key:"remove",value:function(t){return this.buffs.hasOwnProperty(t)&&delete this.buffs[t],this}},{key:"buff",value:function(t){var e,n,s=t,r=this.buffs;for(var i in r)if((e=r[i]).enable)switch(n=e.type,e=e.value,n){case l:s+=e;break;case b:s+=t*e}return s}}]),t}(),l=0,b=1,y=Phaser.Utils.Objects.IsPlainObject,p=Phaser.Utils.Objects.GetValue,d=function(){function s(t,e){if(o(this,s),y(t)){var n=t;t=p(n,"min",void 0),e=p(n,"max",void 0)}this.setMin(t),this.setMax(e)}return f(s,[{key:"setMin",value:function(t){return this.min=t,this}},{key:"setMax",value:function(t){return this.max=t,this}},{key:"clamp",value:function(t){return void 0!==this.min&&t<this.min?t=this.min:void 0!==this.max&&t>this.max&&(t=this.max),t}}]),s}(),e={setBaseValue:function(t,e){return this.baseValues[t]=e,this.set(t,this.getBuffResult(t)),this},removeBaseValue:function(t){return this.baseValues.hasOwnProperty(t)&&(delete this.baseValues[t],this.remove(t)),this},setBuff:function(t,e,n){return this.buffs.hasOwnProperty(t)||(this.buffs[t]=new u),this.buffs[t].set(e,n),this.set(t,this.getBuffResult(t)),this},enableBuff:function(t,e,n){return this.buffs.hasOwnProperty(t)||(this.buffs[t]=new u),this.buffs[t].setEnable(e,n),this.set(t,this.getBuffResult(t)),this},removeBuff:function(t,e){return this.buffs.hasOwnProperty(t)&&(void 0===e?delete this.buffs[t]:this.buffs[t].remove(e)),this.set(t,this.getBuffResult(t)),this},setMin:function(t,e){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t].setMin(e),this.set(t,this.getBuffResult(t)),this},setMax:function(t,e){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t].setMax(e),this.set(t,this.getBuffResult(t)),this},setBounds:function(t,e,n){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t].setMin(e).setMax(n),this.set(t,this.getBuffResult(t)),this},getBuffResult:function(t){return this.clamp(t,this.buff(t))},buff:function(t,e){return void 0===e&&(e=this.getBaseValue(t)),this.buffs.hasOwnProperty(t)?this.buffs[t].buff(e):e},clamp:function(t,e){return void 0===e&&(e=this.list[t]),this.bounds.hasOwnProperty(t)?this.bounds[t].clamp(e):e},getBaseValue:function(t){return this.baseValues.hasOwnProperty(t)||(this.baseValues[t]=0),this.baseValues[t]},getBuffs:function(t,e){var n=this.buffs[t];return void 0===e?n:n&&n.hasOwnProperty(e)?n[e]:void 0},getBuffValue:function(t,e){return this.getBuffs(t,e).value},getBounds:function(t){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t]},getMinBound:function(t){return this.getBounds(t).min},getMaxBound:function(t){return this.getBounds(t).max}},v=Phaser.Data.DataManager,m=Phaser.Events.EventEmitter,w=function(){t(u,v);var i=h(u);function u(t,e){var n;o(this,u);var s=void 0===e;if(s&&(e=new m),n=i.call(this,t,e),s){var r=t.events?t.events:t;r&&r.once("destroy",n.destroy,a(n))}return c(a(n)),n}return f(u)}();return Object.assign(w.prototype,e),function(){t(n,Phaser.Plugins.BasePlugin);var e=h(n);function n(t){return o(this,n),e.call(this,t)}return f(n,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"add",value:function(t,e){return new w(t,e)}},{key:"extend",value:function(t){return c(t)}}]),n}()});
